# IaC AWS Portfolio Environment (Terraform/Ansible)

This repository defines a small, production‑style AWS environment using Terraform and Ansible, designed to showcase Infrastructure as Code, modular design, and CI/CD‑friendly structure for Release, DevOps and Cloud roles.

## Architecture Overview

The environment models a simple web application stack:

- One VPC with separate public and private subnets
- A single EC2 instance in the public subnet for the app tier
- A static website hosted on S3
- Security groups enforcing least‑privilege network access

The code is organized into reusable Terraform modules and environment‑specific root configurations (`dev`, `prod`).

### High‑Level Design

- **Network**
  - 1 VPC (e.g., `10.0.0.0/16`)
  - 1 public subnet (e.g., `10.0.1.0/24`) for the EC2 app instance
  - 1 private subnet (e.g., `10.0.2.0/24`) reserved for future backend services
  - Internet Gateway and a NAT Gateway for outbound internet access from private subnets
- **Compute**
  - 1 EC2 instance (t3.micro by default) running in the public subnet
  - User data script to bootstrap the application (e.g., simple web page)
- **Static Website**
  - 1 S3 bucket configured for static website hosting (index + error pages)
- **Security**
  - Web security group allowing HTTP/HTTPS from the internet
  - SSH security group allowing SSH from a configurable CIDR range
  - Default outbound egress to the internet for updates and package downloads

## Terraform Code Structure

The `terraform/` directory is organized into three main layers to support modularity and state management:

### 1. Bootstrap (`terraform/bootstrap/`)
This directory contains the initial Terraform configuration to provision the **Remote Backend** infrastructure. It creates:
- An **S3 Bucket** to store the Terraform state files securely.
- A **DynamoDB Table** to handle state locking and consistency checking.

*Usage*: Run this once initially to set up the backend before deploying environments.

### 2. Modules (`terraform/modules/`)
Reusable infrastructure components are defined here. These modules abstract the complexity of resources:
- **network**: Provisions the VPC, public/private subnets, and routing tables.
- **security_groups**: Defines firewall rules for Web (HTTP/HTTPS) and SSH access.
- **ec2_app**: Wraps the EC2 instance creation, attaching security groups and subnets.
- **s3_static_site**: Configures an S3 bucket for static website hosting with public read access.

### 3. Environments (`terraform/environments/`)
This directory contains the live configurations for specific environments (e.g., `dev`).
- **dev**: The development environment configuration.
    - **backend.tf**: Configures the remote state backend using resources from `bootstrap`.
    - **main.tf**: Calls the modules defined in `terraform/modules/` with environment-specific variables.
    - **ansible_inventory.tpl**: A template used to generate an Ansible inventory file dynamically based on the provisioned EC2 IP address.

## Ansible Code Structure

The `ansible/` directory handles configuration management for the provisioned EC2 instances.

- **inventory-dev.ini**: Defines the target hosts. This file is automatically generated by Terraform (via `local_file` resource in `dev/main.tf`) to include the dynamic public IP of the EC2 instance.
- **site-dev.yml**: The main playbook that orchestrates the configuration for the development environment.
- **roles/**: Contains reusable Ansible roles.
    - **webserver**: Installs Nginx, Git, and deploys the static site content to the web server.

## What This Demonstrates

This project is designed as a portfolio artifact to highlight:

- Infrastructure as Code with Terraform and AWS
- Modular design (network, security, compute, storage) and reuse across environments
- Environment separation via dedicated root modules and state
- Clear inputs/outputs and tagging strategy for real‑world operations

It can be extended with:

- RDS or other managed databases in the private subnet
- CloudFront in front of the S3 static site
- CI/CD pipelines (GitHub Actions) that run `fmt`, `validate`, `plan`, and security scans (e.g., Checkov/tfsec) on pull requests.
